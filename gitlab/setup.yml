include:
    - gitlab/npm.yml

.panda:
    script:
    - PANDA_SDK_VERSION=1.5.0-dev.32627 npm run panda:sdk:check-install --prefix ./external/incremental/tools/panda

libarkts regenerate:
    stage: build
    tags:
    - idlize-ci
    - koala-ci
    script:
    - !reference [.npm, script]
    - !reference [.panda, script]
    - cd external/ui2abc/libarkts
    - npm run regenerate
    - npm run compile
    - npm run compile:plugins
    - cd -
    artifacts:
        paths:
        - external/ui2abc/libarkts/lib
        - external/ui2abc/libarkts/build
        expire_in: 1 day

download sdk:
    stage: build
    tags:
    - idlize-ci
    - koala-ci
    script:
    - !reference [.npm, script]
    - !reference [.panda, script]
    - npm run download:sdk
    artifacts:
        paths:
        - sdk-patched
        - sdk-patched-arkts
        expire_in: 1 day