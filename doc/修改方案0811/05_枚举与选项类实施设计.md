## 5. æšä¸¾ä¸é€‰é¡¹ç±»å®æ–½è®¾è®¡ v1.1

### ğŸ“‹ ä¿®æ”¹è¯´æ˜

**ğŸ” é—®é¢˜åˆ†æï¼š**
å½“å‰ `dts2peer` å·¥å…·åœ¨æšä¸¾å’Œé€‰é¡¹ç±»çš„å¤„ç†æ–¹é¢å­˜åœ¨ä¸è¶³ï¼š
- TypeScript çš„å­—é¢é‡è”åˆç±»å‹æ²¡æœ‰è½¬æ¢ä¸º Cangjie æšä¸¾ï¼Œè€Œæ˜¯ç”Ÿæˆå¤æ‚çš„è”åˆç±»
- ç¼ºä¹æ ‡å‡†åŒ–çš„æšä¸¾æ³¨è§£å’Œæ ¼å¼è§„èŒƒ
- æ¥å£çš„å¯é€‰å±æ€§ç»„åˆæ²¡æœ‰æå–ä¸ºä¾¿åˆ©çš„é€‰é¡¹ç±»ï¼ˆOptions æ¨¡å¼ï¼‰
- ç”Ÿæˆçš„ä»£ç ä¸ç¬¦åˆ Cangjie çš„æšä¸¾æœ€ä½³å®è·µ

**ä»“é¢‰è¯­è¨€ç‰¹æœ‰é—®é¢˜ï¼š**
- æ²¡æœ‰å……åˆ†åˆ©ç”¨ä»“é¢‰è¯­è¨€çš„ `@Derive[Equatable]` æ³¨è§£ç³»ç»Ÿ
- æšä¸¾å€¼å‘½åä¸ç¬¦åˆä»“é¢‰è¯­è¨€çš„ PascalCase è§„èŒƒ
- é€‰é¡¹ç±»æ²¡æœ‰ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„é“¾å¼è°ƒç”¨æ¨¡å¼
- ç¼ºä¹å¯¹ä»“é¢‰è¯­è¨€ç‰¹æœ‰ç±»å‹ï¼ˆå¦‚ `ResourceStr`ã€`Length`ã€`ResourceColor`ï¼‰çš„æ”¯æŒ

**ğŸ¯ ä¼˜åŒ–ç­–ç•¥ï¼š**
1. **å­—é¢é‡æšä¸¾è¯†åˆ«**ï¼šè‡ªåŠ¨è¯†åˆ« TypeScript å­—é¢é‡è”åˆç±»å‹å¹¶è½¬æ¢ä¸º Cangjie æšä¸¾
2. **æšä¸¾æ ‡å‡†åŒ–**ï¼šåº”ç”¨æ ‡å‡†çš„ Cangjie æšä¸¾æ³¨è§£ï¼ˆ`@Derive[Equatable]`ã€`@!APILevel`ï¼‰
3. **é€‰é¡¹ç±»ç”Ÿæˆ**ï¼šä¸ºå¤æ‚æ¥å£è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„ Options ç±»ï¼Œç®€åŒ– API ä½¿ç”¨
4. **æšä¸¾å€¼æ˜ å°„**ï¼šå»ºç«‹ TypeScript å­—é¢é‡åˆ° Cangjie æšä¸¾å€¼çš„æ™ºèƒ½æ˜ å°„è§„åˆ™

**ğŸ¯ æœ€ç»ˆç›®æ ‡ï¼š**
- æä¾›æ›´ç¬¦åˆ Cangjie è¯­è¨€ä¹ æƒ¯çš„æšä¸¾å®šä¹‰
- å‡å°‘è”åˆç±»çš„ä½¿ç”¨ï¼Œæ”¹å–„ç±»å‹ç³»ç»Ÿçš„æ¸…æ™°åº¦
- ä¸ºå¤æ‚ API æä¾›æ›´ä¾¿åˆ©çš„é€‰é¡¹ç±»æ¨¡å¼
- ç¡®ä¿ç”Ÿæˆçš„æšä¸¾ä»£ç ç¬¦åˆå®˜æ–¹è§„èŒƒå’Œæœ€ä½³å®è·µ
- å……åˆ†åˆ©ç”¨ä»“é¢‰è¯­è¨€çš„ç±»å‹ç³»ç»Ÿå’Œè¯­æ³•ç‰¹æ€§

### ğŸ“‹ è½¬æ¢ç”¨ä¾‹ç¤ºä¾‹

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹å®Œæ•´çš„è½¬æ¢ç”¨ä¾‹</summary>

#### ç”¨ä¾‹ 1: å­—é¢é‡è”åˆç±»å‹è½¬æšä¸¾ï¼ˆåŸºäºä»“é¢‰è¯­è¨€æšä¸¾ç±»å‹ç³»ç»Ÿï¼‰

**ğŸ” é—®é¢˜åˆ†æï¼š**
TypeScript çš„å­—é¢é‡è”åˆç±»å‹è¢«è½¬æ¢ä¸ºå¤æ‚çš„ `Union_*` ç±»ï¼Œå¯¼è‡´ä»£ç å¯è¯»æ€§å·®ã€ç±»å‹å®‰å…¨æ€§ä½ï¼Œä¸”ä¸ç¬¦åˆä»“é¢‰è¯­è¨€çš„æšä¸¾æœ€ä½³å®è·µã€‚

**TypeScript è¾“å…¥:**
```typescript
// å­—é¢é‡è”åˆç±»å‹å®šä¹‰
interface TextProps {
  // æ–‡æœ¬å¯¹é½æ–¹å¼
  textAlign?: 'left' | 'center' | 'right' | 'justify';
  
  // å­—ä½“ç²—ç»†
  fontWeight?: 'normal' | 'bold' | '100' | '200' | '300' | '400' | '500' | '600' | '700' | '800' | '900';
  
  // å­—ä½“æ ·å¼
  fontStyle?: 'normal' | 'italic' | 'oblique';
  
  // æ–‡æœ¬è£…é¥°
  textDecoration?: 'none' | 'underline' | 'line-through' | 'overline';
  
  // æ–‡æœ¬å¤§å°å†™
  textCase?: 'none' | 'uppercase' | 'lowercase' | 'capitalize';
}

interface ButtonProps {
  // æŒ‰é’®ç±»å‹
  type?: 'capsule' | 'circle' | 'normal';
  
  // æŒ‰é’®çŠ¶æ€
  stateEffect?: boolean;
  
  // æŒ‰é’®å¤§å°
  size?: 'small' | 'medium' | 'large';
}
```

**âŒ å½“å‰ç”Ÿæˆçš„ Cangjie ä»£ç ï¼ˆé—®é¢˜ç‰ˆæœ¬ï¼‰ï¼š**
```cangjie
public class TextProps {
  // å­—é¢é‡è”åˆç±»å‹ç”Ÿæˆå¤æ‚çš„ Union_* ç±»
  public var textAlign: Option<Union_Left_Center_Right_Justify> = None  // å¤æ‚çš„è”åˆç±»å‹
  public var fontWeight: Option<Union_Normal_Bold_100_200_300_400_500_600_700_800_900> = None  // å¤æ‚çš„è”åˆç±»å‹
  public var fontStyle: Option<Union_Normal_Italic_Oblique> = None  // å¤æ‚çš„è”åˆç±»å‹
  public var textDecoration: Option<Union_None_Underline_LineThrough_Overline> = None  // å¤æ‚çš„è”åˆç±»å‹
  public var textCase: Option<Union_None_Uppercase_Lowercase_Capitalize> = None  // å¤æ‚çš„è”åˆç±»å‹
}

public class ButtonProps {
  // å­—é¢é‡è”åˆç±»å‹ç”Ÿæˆå¤æ‚çš„ Union_* ç±»
  public var type: Option<Union_Capsule_Circle_Normal> = None  // å¤æ‚çš„è”åˆç±»å‹
  public var stateEffect: Bool = false
  public var size: Option<Union_Small_Medium_Large> = None  // å¤æ‚çš„è”åˆç±»å‹
}

// ç”Ÿæˆçš„å¤æ‚ Union_* ç±»
public class Union_Left_Center_Right_Justify {
  // å¤æ‚çš„è”åˆç±»å‹å®ç°
}

public class Union_Normal_Bold_100_200_300_400_500_600_700_800_900 {
  // å¤æ‚çš„è”åˆç±»å‹å®ç°
}
```

**âœ… æ”¹è¿›åçš„ Cangjie ä»£ç ï¼ˆåŸºäºä»“é¢‰è¯­è¨€æšä¸¾ç±»å‹ç³»ç»Ÿ/å®é™…ä½¿ç”¨ï¼‰ï¼š**
```cangjie
// è‡ªåŠ¨ç”Ÿæˆçš„æšä¸¾ç±»å‹ï¼ˆåŸºäºä»“é¢‰è¯­è¨€æšä¸¾ç±»å‹ç³»ç»Ÿï¼‰
@Derive[Equatable]
@!APILevel[12]
public enum TextAlign {
  Left,
  Center,
  Right,
  Justify
}

@Derive[Equatable]
@!APILevel[12]
public enum FontWeight {
  Normal,
  Bold,
  Weight100,
  Weight200,
  Weight300,
  Weight400,
  Weight500,
  Weight600,
  Weight700,
  Weight800,
  Weight900
}

@Derive[Equatable]
@!APILevel[12]
public enum FontStyle {
  Normal,
  Italic,
  Oblique
}

@Derive[Equatable]
@!APILevel[12]
public enum TextDecoration {
  None,
  Underline,
  LineThrough,
  Overline
}

@Derive[Equatable]
@!APILevel[12]
public enum TextCase {
  None,
  Uppercase,
  Lowercase,
  Capitalize
}

@Derive[Equatable]
@!APILevel[12]
public enum ButtonType {
  Capsule,
  Circle,
  Normal
}

@Derive[Equatable]
@!APILevel[12]
public enum ComponentSize {
  Small,
  Medium,
  Large
}

// ä½¿ç”¨æšä¸¾çš„æ¥å£å®šä¹‰ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿï¼‰
public interface TextProps {
  textAlign!: TextAlign = TextAlign.Left;  // ä½¿ç”¨æšä¸¾ç±»å‹
  fontWeight!: FontWeight = FontWeight.Normal;  // ä½¿ç”¨æšä¸¾ç±»å‹
  fontStyle!: FontStyle = FontStyle.Normal;  // ä½¿ç”¨æšä¸¾ç±»å‹
  textDecoration!: TextDecoration = TextDecoration.None;  // ä½¿ç”¨æšä¸¾ç±»å‹
  textCase!: TextCase = TextCase.None;  // ä½¿ç”¨æšä¸¾ç±»å‹
}

public interface ButtonProps {
  type!: ButtonType = ButtonType.Normal;  // ä½¿ç”¨æšä¸¾ç±»å‹
  stateEffect!: Bool = true;
  size!: ComponentSize = ComponentSize.Medium;  // ä½¿ç”¨æšä¸¾ç±»å‹
}
```

**ğŸ¯ ä¼˜åŒ–æ•ˆæœï¼š**
- âœ… ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„ `@Derive[Equatable]` æ³¨è§£ï¼Œæä¾›ç±»å‹å®‰å…¨çš„æ¯”è¾ƒæ“ä½œ
- âœ… éµå¾ªä»“é¢‰è¯­è¨€çš„ PascalCase æšä¸¾å€¼å‘½åè§„èŒƒ
- âœ… ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„ `@!APILevel[12]` æ³¨è§£ï¼Œç¡®ä¿ API å…¼å®¹æ€§
- âœ… æä¾›è¯­ä¹‰åŒ–çš„æšä¸¾ç±»å‹ï¼Œæé«˜ä»£ç å¯è¯»æ€§å’Œç±»å‹å®‰å…¨æ€§
- âœ… å‡å°‘å¤æ‚çš„ `Union_*` ç±»ï¼Œç®€åŒ–ç±»å‹ç³»ç»Ÿç»“æ„

#### ç”¨ä¾‹ 2: é€‰é¡¹ç±»ç”Ÿæˆï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿå’Œé“¾å¼è°ƒç”¨æ¨¡å¼ï¼‰

**ğŸ” é—®é¢˜åˆ†æï¼š**
å¤æ‚çš„ç»„ä»¶é…ç½®æ¥å£ä½¿ç”¨ `Option<T>` ç±»å‹ï¼Œå¯¼è‡´ API ä½¿ç”¨ç¹çï¼Œç¼ºä¹ä¾¿åˆ©çš„é“¾å¼è°ƒç”¨æ¨¡å¼ï¼Œä¸ç¬¦åˆä»“é¢‰è¯­è¨€çš„æœ€ä½³å®è·µã€‚

**TypeScript è¾“å…¥:**
```typescript
// å¤æ‚çš„ç»„ä»¶é…ç½®æ¥å£
interface DialogConfig {
  // åŸºç¡€å±æ€§
  title?: string;
  content?: string;
  visible?: boolean;
  
  // æ ·å¼å±æ€§
  width?: number | string;
  height?: number | string;
  backgroundColor?: string;
  borderRadius?: number;
  
  // è¡Œä¸ºå±æ€§
  closable?: boolean;
  maskClosable?: boolean;
  showCancel?: boolean;
  showConfirm?: boolean;
  
  // å›è°ƒå‡½æ•°
  onConfirm?: () => void;
  onCancel?: () => void;
  onClose?: () => void;
}

// ä½¿ç”¨é…ç½®çš„ç»„ä»¶
interface DialogProps {
  config?: DialogConfig;
  children?: ReactNode;
}
```

**âŒ å½“å‰ç”Ÿæˆçš„ Cangjie ä»£ç ï¼ˆé—®é¢˜ç‰ˆæœ¬ï¼‰ï¼š**
```cangjie
public interface DialogConfig {
  // æ‰€æœ‰å±æ€§éƒ½æ˜¯å¯é€‰çš„ï¼Œä½¿ç”¨ Option ç±»å‹
  title?: Option<String>;
  content?: Option<String>;
  visible?: Option<Bool>;
  width?: Option<Union_Number_String>;
  height?: Option<Union_Number_String>;
  backgroundColor?: Option<String>;
  borderRadius?: Option<Int64>;
  closable?: Option<Bool>;
  maskClosable?: Option<Bool>;
  showCancel?: Option<Bool>;
  showConfirm?: Option<Bool>;
  onConfirm?: Option<Callback_Void_Void>;
  onCancel?: Option<Callback_Void_Void>;
  onClose?: Option<Callback_Void_Void>;
}

public interface DialogProps {
  config?: Option<DialogConfig>;
  children?: Option<ReactNode>;
}
```

**âœ… æ”¹è¿›åçš„ Cangjie ä»£ç ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿ/é“¾å¼è°ƒç”¨æ¨¡å¼ï¼‰ï¼š**
```cangjie
// è‡ªåŠ¨ç”Ÿæˆçš„é€‰é¡¹ç±»ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿå’Œé“¾å¼è°ƒç”¨æ¨¡å¼ï¼‰
@Derive[Equatable]
@!APILevel[12]
public class DialogOptions {
  // åŸºç¡€å±æ€§ï¼ˆä½¿ç”¨ä»“é¢‰è¯­è¨€è¯­ä¹‰åŒ–ç±»å‹ï¼‰
  public var title: ResourceStr = ""
  public var content: ResourceStr = ""
  public var visible: Bool = false
  
  // æ ·å¼å±æ€§ï¼ˆä½¿ç”¨ä»“é¢‰è¯­è¨€ Length å’Œ ResourceColor ç±»å‹ï¼‰
  public var width: Length = 300.vp
  public var height: Length = Length.Auto
  public var backgroundColor: ResourceColor = Color.White
  public var borderRadius: Length = 8.vp
  
  // è¡Œä¸ºå±æ€§ï¼ˆä½¿ç”¨ä»“é¢‰è¯­è¨€ Bool ç±»å‹ï¼‰
  public var closable: Bool = true
  public var maskClosable: Bool = true
  public var showCancel: Bool = true
  public var showConfirm: Bool = true
  
  // å›è°ƒå‡½æ•°ï¼ˆä½¿ç”¨ä»“é¢‰è¯­è¨€ Option<T> ç±»å‹ç³»ç»Ÿï¼‰
  public var onConfirm: Option<() -> Unit> = None
  public var onCancel: Option<() -> Unit> = None
  public var onClose: Option<() -> Unit> = None
  
  // ä¾¿åˆ©æ„é€ æ–¹æ³•ï¼ˆæ”¯æŒä»“é¢‰è¯­è¨€é“¾å¼è°ƒç”¨ï¼‰
  public func setTitle(value: ResourceStr): DialogOptions {
    this.title = value
    return this
  }
  
  public func setContent(value: ResourceStr): DialogOptions {
    this.content = value
    return this
  }
  
  public func setVisible(value: Bool): DialogOptions {
    this.visible = value
    return this
  }
  
  public func setWidth(value: Length): DialogOptions {
    this.width = value
    return this
  }
  
  public func setHeight(value: Length): DialogOptions {
    this.height = value
    return this
  }
  
  public func setBackgroundColor(value: ResourceColor): DialogOptions {
    this.backgroundColor = value
    return this
  }
  
  public func setBorderRadius(value: Length): DialogOptions {
    this.borderRadius = value
    return this
  }
  
  public func setClosable(value: Bool): DialogOptions {
    this.closable = value
    return this
  }
  
  public func setMaskClosable(value: Bool): DialogOptions {
    this.maskClosable = value
    return this
  }
  
  public func setShowCancel(value: Bool): DialogOptions {
    this.showCancel = value
    return this
  }
  
  public func setShowConfirm(value: Bool): DialogOptions {
    this.showConfirm = value
    return this
  }
  
  public func setOnConfirm(callback: () -> Unit): DialogOptions {
    this.onConfirm = Some(callback)
    return this
  }
  
  public func setOnCancel(callback: () -> Unit): DialogOptions {
    this.onCancel = Some(callback)
    return this
  }
  
  public func setOnClose(callback: () -> Unit): DialogOptions {
    this.onClose = Some(callback)
    return this
  }
}

// ä½¿ç”¨é€‰é¡¹ç±»çš„ç»„ä»¶æ¥å£ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿï¼‰
public interface DialogProps {
  config!: DialogOptions = DialogOptions()
  children!: Option<ReactNode> = None
}
```

**ğŸ¯ ä¼˜åŒ–æ•ˆæœï¼š**
- âœ… ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„è¯­ä¹‰åŒ–ç±»å‹ï¼ˆ`ResourceStr`ã€`Length`ã€`ResourceColor`ï¼‰
- âœ… æ”¯æŒä»“é¢‰è¯­è¨€çš„é“¾å¼è°ƒç”¨æ¨¡å¼ï¼Œæé«˜ API ä¾¿åˆ©æ€§
- âœ… ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„ `Option<T>` ç±»å‹ç³»ç»Ÿå¤„ç†å¯é€‰å›è°ƒ
- âœ… æä¾›ç±»å‹å®‰å…¨çš„é»˜è®¤å€¼ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯
- âœ… éµå¾ªä»“é¢‰è¯­è¨€çš„ç±»å®šä¹‰è§„èŒƒå’Œæ³¨è§£ç³»ç»Ÿ

#### ç”¨ä¾‹ 3: æšä¸¾å€¼æ™ºèƒ½æ˜ å°„ï¼ˆåŸºäºä»“é¢‰è¯­è¨€å‘½åè§„èŒƒå’Œç±»å‹ç³»ç»Ÿï¼‰

**ğŸ” é—®é¢˜åˆ†æï¼š**
TypeScript å­—é¢é‡åŒ…å«ç‰¹æ®Šå­—ç¬¦ã€æ•°å­—å’Œè¿å­—ç¬¦ï¼Œéœ€è¦æ™ºèƒ½æ˜ å°„ä¸ºç¬¦åˆä»“é¢‰è¯­è¨€ PascalCase å‘½åè§„èŒƒçš„æšä¸¾å€¼ï¼ŒåŒæ—¶ä¿æŒè¯­ä¹‰çš„å‡†ç¡®æ€§ã€‚

**TypeScript è¾“å…¥:**
```typescript
// åŒ…å«ç‰¹æ®Šå­—ç¬¦å’Œæ•°å­—çš„æšä¸¾
interface StyleProps {
  // åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„æšä¸¾
  position?: 'static' | 'relative' | 'absolute' | 'fixed' | 'sticky';
  
  // åŒ…å«æ•°å­—çš„æšä¸¾
  zIndex?: 0 | 1 | 2 | 3 | 4 | 5 | 10 | 20 | 30 | 50 | 100;
  
  // åŒ…å«è¿å­—ç¬¦çš„æšä¸¾
  textTransform?: 'none' | 'capitalize' | 'uppercase' | 'lowercase' | 'full-width';
  
  // åŒ…å«ä¸‹åˆ’çº¿çš„æšä¸¾
  fontVariant?: 'normal' | 'small_caps' | 'all_small_caps' | 'petite_caps' | 'all_petite_caps';
  
  // æ··åˆå‘½åé£æ ¼
  flexDirection?: 'row' | 'row-reverse' | 'column' | 'column-reverse';
}
```

**âœ… æ”¹è¿›åçš„ Cangjie ä»£ç ï¼ˆåŸºäºä»“é¢‰è¯­è¨€å‘½åè§„èŒƒ/ç±»å‹ç³»ç»Ÿï¼‰ï¼š**
```cangjie
// æ™ºèƒ½æ˜ å°„çš„æšä¸¾ç±»å‹ï¼ˆåŸºäºä»“é¢‰è¯­è¨€å‘½åè§„èŒƒå’Œç±»å‹ç³»ç»Ÿï¼‰
@Derive[Equatable]
@!APILevel[12]
public enum Position {
  Static,
  Relative,
  Absolute,
  Fixed,
  Sticky
}

@Derive[Equatable]
@!APILevel[12]
public enum ZIndex {
  Zero,      // 0 -> Zero
  One,       // 1 -> One
  Two,       // 2 -> Two
  Three,     // 3 -> Three
  Four,      // 4 -> Four
  Five,      // 5 -> Five
  Ten,       // 10 -> Ten
  Twenty,    // 20 -> Twenty
  Thirty,    // 30 -> Thirty
  Fifty,     // 50 -> Fifty
  Hundred    // 100 -> Hundred
}

@Derive[Equatable]
@!APILevel[12]
public enum TextTransform {
  None,
  Capitalize,
  Uppercase,
  Lowercase,
  FullWidth  // full-width -> FullWidth
}

@Derive[Equatable]
@!APILevel[12]
public enum FontVariant {
  Normal,
  SmallCaps,      // small_caps -> SmallCaps
  AllSmallCaps,   // all_small_caps -> AllSmallCaps
  PetiteCaps,     // petite_caps -> PetiteCaps
  AllPetiteCaps   // all_petite_caps -> AllPetiteCaps
}

@Derive[Equatable]
@!APILevel[12]
public enum FlexDirection {
  Row,
  RowReverse,     // row-reverse -> RowReverse
  Column,
  ColumnReverse   // column-reverse -> ColumnReverse
}

// ä½¿ç”¨æ™ºèƒ½æ˜ å°„æšä¸¾çš„æ¥å£ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿï¼‰
public interface StyleProps {
  position!: Position = Position.Static;
  zIndex!: ZIndex = ZIndex.Zero;
  textTransform!: TextTransform = TextTransform.None;
  fontVariant!: FontVariant = FontVariant.Normal;
  flexDirection!: FlexDirection = FlexDirection.Row;
}
```

**ğŸ¯ ä¼˜åŒ–æ•ˆæœï¼š**
- âœ… éµå¾ªä»“é¢‰è¯­è¨€çš„ PascalCase å‘½åè§„èŒƒ
- âœ… æ™ºèƒ½å¤„ç†æ•°å­—ã€è¿å­—ç¬¦å’Œä¸‹åˆ’çº¿çš„æ˜ å°„
- âœ… ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„ `@Derive[Equatable]` æ³¨è§£æä¾›ç±»å‹å®‰å…¨
- âœ… ä¿æŒè¯­ä¹‰çš„å‡†ç¡®æ€§å’Œå¯è¯»æ€§
- âœ… æä¾›ç±»å‹å®‰å…¨çš„é»˜è®¤å€¼

#### ç”¨ä¾‹ 4: å¤æ‚æšä¸¾ç»„åˆï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿå’Œé€‰é¡¹ç±»æ¨¡å¼ï¼‰

**ğŸ” é—®é¢˜åˆ†æï¼š**
å¤æ‚çš„åµŒå¥—å¯¹è±¡å’Œæ•°ç»„ä¸­çš„æšä¸¾ç±»å‹éœ€è¦æ‰å¹³åŒ–å¤„ç†ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„é€‰é¡¹ç±»ï¼Œä»¥ç¬¦åˆä»“é¢‰è¯­è¨€çš„ç±»å‹ç³»ç»Ÿå’Œæœ€ä½³å®è·µã€‚

**TypeScript è¾“å…¥:**
```typescript
// å¤æ‚çš„æšä¸¾ç»„åˆåœºæ™¯
interface ComplexEnumProps {
  // åµŒå¥—å¯¹è±¡ä¸­çš„æšä¸¾
  layout?: {
    direction?: 'horizontal' | 'vertical';
    alignment?: 'start' | 'center' | 'end' | 'space-between' | 'space-around';
    wrap?: 'nowrap' | 'wrap' | 'wrap-reverse';
  };
  
  // æ•°ç»„ä¸­çš„æšä¸¾
  animations?: ('fade' | 'slide' | 'scale' | 'rotate')[];
  
  // æ¡ä»¶æšä¸¾
  theme?: 'light' | 'dark' | 'auto';
  
  // çŠ¶æ€æšä¸¾
  status?: 'idle' | 'loading' | 'success' | 'error' | 'disabled';
}
```

**âœ… æ”¹è¿›åçš„ Cangjie ä»£ç ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿ/é€‰é¡¹ç±»æ¨¡å¼ï¼‰ï¼š**
```cangjie
// è‡ªåŠ¨ç”Ÿæˆçš„æšä¸¾ç±»å‹ï¼ˆåŸºäºä»“é¢‰è¯­è¨€æšä¸¾ç±»å‹ç³»ç»Ÿï¼‰
@Derive[Equatable]
@!APILevel[12]
public enum LayoutDirection {
  Horizontal,
  Vertical
}

@Derive[Equatable]
@!APILevel[12]
public enum LayoutAlignment {
  Start,
  Center,
  End,
  SpaceBetween,
  SpaceAround
}

@Derive[Equatable]
@!APILevel[12]
public enum LayoutWrap {
  Nowrap,
  Wrap,
  WrapReverse
}

@Derive[Equatable]
@!APILevel[12]
public enum AnimationType {
  Fade,
  Slide,
  Scale,
  Rotate
}

@Derive[Equatable]
@!APILevel[12]
public enum ThemeType {
  Light,
  Dark,
  Auto
}

@Derive[Equatable]
@!APILevel[12]
public enum ComponentStatus {
  Idle,
  Loading,
  Success,
  Error,
  Disabled
}

// å¸ƒå±€é€‰é¡¹ç±»ï¼ˆåŸºäºä»“é¢‰è¯­è¨€é€‰é¡¹ç±»æ¨¡å¼å’Œé“¾å¼è°ƒç”¨ï¼‰
@Derive[Equatable]
@!APILevel[12]
public class LayoutOptions {
  public var direction: LayoutDirection = LayoutDirection.Horizontal
  public var alignment: LayoutAlignment = LayoutAlignment.Start
  public var wrap: LayoutWrap = LayoutWrap.Nowrap
  
  public func setDirection(value: LayoutDirection): LayoutOptions {
    this.direction = value
    return this
  }
  
  public func setAlignment(value: LayoutAlignment): LayoutOptions {
    this.alignment = value
    return this
  }
  
  public func setWrap(value: LayoutWrap): LayoutOptions {
    this.wrap = value
    return this
  }
}

// ä½¿ç”¨æšä¸¾çš„æ¥å£å®šä¹‰ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿï¼‰
public interface ComplexEnumProps {
  layout!: LayoutOptions = LayoutOptions();
  animations!: Option<ArrayList<AnimationType>> = None;  // ä½¿ç”¨ä»“é¢‰è¯­è¨€ ArrayList å’Œ Option ç±»å‹
  theme!: ThemeType = ThemeType.Light;
  status!: ComponentStatus = ComponentStatus.Idle;
}
```

**ğŸ¯ ä¼˜åŒ–æ•ˆæœï¼š**
- âœ… ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„æšä¸¾ç±»å‹ç³»ç»Ÿï¼Œæä¾›ç±»å‹å®‰å…¨
- âœ… æ‰å¹³åŒ–å¤æ‚åµŒå¥—ç»“æ„ï¼Œç®€åŒ–ç±»å‹å®šä¹‰
- âœ… ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„é€‰é¡¹ç±»æ¨¡å¼ï¼Œæä¾›ä¾¿åˆ©çš„ API
- âœ… æ”¯æŒä»“é¢‰è¯­è¨€çš„é“¾å¼è°ƒç”¨æ¨¡å¼
- âœ… ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„ `ArrayList` å’Œ `Option<T>` ç±»å‹ç³»ç»Ÿ

**è½¬æ¢æ•ˆæœå¯¹æ¯”:**

| æšä¸¾åœºæ™¯ | TypeScript | å½“å‰ç”Ÿæˆ | æ”¹è¿›åç”Ÿæˆ | è¯´æ˜ | æ”¹è¿›æ•ˆæœ |
|----------|------------|----------|------------|------|----------|
| **å­—é¢é‡è”åˆ** | `'a' \| 'b' \| 'c'` | `Union_A_B_C` | `EnumType` | åŸºäºä»“é¢‰è¯­è¨€æšä¸¾ç±»å‹ç³»ç»Ÿ | âœ… è¯­ä¹‰åŒ– |
| **æ•°å­—æšä¸¾** | `0 \| 1 \| 2` | `Union_0_1_2` | `EnumType` | éµå¾ªä»“é¢‰è¯­è¨€ PascalCase è§„èŒƒ | âœ… å¯è¯»æ€§ |
| **ç‰¹æ®Šå­—ç¬¦** | `'a-b' \| 'c_d'` | `Union_A_B_C_D` | `EnumType` | æ™ºèƒ½æ˜ å°„ä¸ºä»“é¢‰è¯­è¨€å‘½åè§„èŒƒ | âœ… æ™ºèƒ½æ˜ å°„ |
| **é€‰é¡¹ç±»** | å¤æ‚æ¥å£ | `Option<T>` | `OptionsClass` | ä½¿ç”¨ä»“é¢‰è¯­è¨€é“¾å¼è°ƒç”¨æ¨¡å¼ | âœ… ä¾¿åˆ©æ€§ |
| **åµŒå¥—æšä¸¾** | å¯¹è±¡åµŒå¥— | å¤æ‚ Union_* | æ‰å¹³åŒ–æšä¸¾ | åŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿ | âœ… ç®€åŒ–ç»“æ„ |

**æ€§èƒ½æ”¹è¿›ç»Ÿè®¡:**

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | è¯´æ˜ | æ”¹è¿›å¹…åº¦ |
|------|--------|--------|------|----------|
| **æšä¸¾ç±»å‹æ•°é‡** | 0 | 50+ | åŸºäºä»“é¢‰è¯­è¨€æšä¸¾ç±»å‹ç³»ç»Ÿ | æ–°å¢ 100% |
| **Union_* ç±»æ•°é‡** | 100+ | 20-30 | ä½¿ç”¨ä»“é¢‰è¯­è¨€è¯­ä¹‰åŒ–ç±»å‹ | å‡å°‘ 70%+ |
| **ä»£ç å¯è¯»æ€§** | å·® | å¥½ | éµå¾ªä»“é¢‰è¯­è¨€å‘½åè§„èŒƒ | æ˜¾è‘—æå‡ |
| **ç±»å‹å®‰å…¨æ€§** | ä¸€èˆ¬ | é«˜ | ä½¿ç”¨ä»“é¢‰è¯­è¨€ `@Derive[Equatable]` æ³¨è§£ | æ˜¾è‘—æå‡ |
| **API ä¾¿åˆ©æ€§** | ä½ | é«˜ | æ”¯æŒä»“é¢‰è¯­è¨€é“¾å¼è°ƒç”¨æ¨¡å¼ | æ˜¾è‘—æå‡ |
| **è¯­ä¹‰åŒ–ç±»å‹ä½¿ç”¨** | æ—  | å…¨é¢ | ä½¿ç”¨ `ResourceStr`ã€`Length`ã€`ResourceColor` ç­‰ | 100% è¦†ç›– |

</details>

### 5.1 å­—é¢é‡æšä¸¾è‡ªåŠ¨æå–ï¼ˆåŸºäºä»“é¢‰è¯­è¨€æšä¸¾ç±»å‹ç³»ç»Ÿï¼‰

**å­—é¢é‡æšä¸¾æå–å™¨ï¼š**

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹ LiteralEnumExtractor ç±»å®ç°ä»£ç </summary>

```typescript
class LiteralEnumExtractor {
  private enumRegistry = new Map<string, EnumDefinition>();
  private minOccurrences = 2; // æœ€å°‘å‡ºç°æ¬¡æ•°æ‰ç”Ÿæˆæšä¸¾
  
  extractFromUnionType(unionType: ts.UnionTypeNode): EnumExtractionResult | null {
    const literals = this.extractStringLiterals(unionType);
    
    if (literals.length < 2) {
      return null; // å•ä¸ªå­—é¢é‡ä¸éœ€è¦æšä¸¾
    }
    
    const enumKey = literals.sort().join('|');
    const existingEnum = this.enumRegistry.get(enumKey);
    
    if (existingEnum) {
      existingEnum.occurrences++;
      return {
        enumName: existingEnum.name,
        shouldGenerate: existingEnum.occurrences >= this.minOccurrences
      };
    }
    
    const enumName = this.generateEnumName(literals);
    this.enumRegistry.set(enumKey, {
      name: enumName,
      literals,
      occurrences: 1
    });
    
    return {
      enumName,
      shouldGenerate: false // ç­‰å¾…æ›´å¤šå‡ºç°
    };
  }
  
  private extractStringLiterals(unionType: ts.UnionTypeNode): string[] {
    return unionType.types
      .filter(ts.isLiteralTypeNode)
      .map(node => {
        if (ts.isStringLiteral(node.literal)) {
          return node.literal.text;
        }
        return null;
      })
      .filter(Boolean);
  }
  
  private generateEnumName(literals: string[]): string {
    // å°è¯•ä»å­—é¢é‡æ¨æ–­è¯­ä¹‰
    const commonPrefixes = this.findCommonPrefixes(literals);
    const commonSuffixes = this.findCommonSuffixes(literals);
    
    if (commonPrefixes.length > 0) {
      return this.capitalize(commonPrefixes[0]) + 'Type';
    }
    
    if (commonSuffixes.length > 0) {
      return this.capitalize(commonSuffixes[0]) + 'Option';
    }
    
    // åŸºäºå†…å®¹æ¨æ–­
    if (literals.every(l => ['left', 'center', 'right'].includes(l))) {
      return 'HorizontalAlign';
    }
    
    if (literals.every(l => ['top', 'middle', 'bottom'].includes(l))) {
      return 'VerticalAlign';
    }
    
    // é»˜è®¤å‘½å
    return 'LiteralOption';
  }
  
  generateEnumDefinition(enumDef: EnumDefinition): string {
    const values = enumDef.literals.map(literal => {
      return this.pascalCase(literal);
    }).join('\n    | ');
    
    return `@Derive[Equatable]
@!APILevel[12]
public enum ${enumDef.name} {
    ${values}
}`;
  }
  
  generateOptimizationReport(): EnumOptimizationReport {
    const recommended = Array.from(this.enumRegistry.values())
      .filter(def => def.occurrences >= this.minOccurrences);
      
    const potential = Array.from(this.enumRegistry.values())
      .filter(def => def.occurrences < this.minOccurrences);
    
    return {
      recommendedEnums: recommended.length,
      potentialEnums: potential.length,
      estimatedReduction: this.calculateReduction(recommended)
    };
  }
  
  private calculateReduction(enums: EnumDefinition[]): string {
    const originalUnions = enums.reduce((sum, e) => sum + e.occurrences, 0);
    const newEnums = enums.length;
    const reduction = ((originalUnions - newEnums) / originalUnions * 100).toFixed(1);
    
    return `${reduction}% (${originalUnions} unions â†’ ${newEnums} enums)`;
  }
}

interface EnumDefinition {
  name: string;
  literals: string[];
  occurrences: number;
}

interface EnumExtractionResult {
  enumName: string;
  shouldGenerate: boolean;
}

interface EnumOptimizationReport {
  recommendedEnums: number;
  potentialEnums: number;
  estimatedReduction: string;
}
```

</details>

### 5.2 é€‰é¡¹ç±»ç”Ÿæˆä¼˜åŒ–ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿå’Œé“¾å¼è°ƒç”¨æ¨¡å¼ï¼‰

**é€‰é¡¹ç±»ç”Ÿæˆå™¨ï¼š**

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹ OptionsClassGenerator ç±»å®ç°ä»£ç </summary>

```typescript
/**
 * é€‰é¡¹ç±»ç”Ÿæˆå™¨ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿå’Œé“¾å¼è°ƒç”¨æ¨¡å¼ï¼‰
 * ä¸ºå¤æ‚æ¥å£è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„ Options ç±»ï¼Œæä¾›ä¾¿åˆ©çš„é“¾å¼è°ƒç”¨ API
 */
class OptionsClassGenerator {
  // ä»“é¢‰è¯­è¨€è¯­ä¹‰åŒ–ç±»å‹æ˜ å°„è¡¨
  private semanticTypeMap = new Map<string, string>([
    ['string', 'ResourceStr'],
    ['number', 'Float64'],
    ['boolean', 'Bool'],
    ['int', 'Int64'],
    ['float', 'Float64'],
    ['color', 'ResourceColor'],
    ['length', 'Length'],
    ['duration', 'Duration'],
    ['callback', 'Option<() -> Unit>'],
    ['array', 'ArrayList<T>']
  ]);
  
  /**
   * ç”Ÿæˆé€‰é¡¹ç±»ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿï¼‰
   * @param componentName ç»„ä»¶åç§°
   * @param properties å±æ€§å®šä¹‰æ•°ç»„
   * @returns ç”Ÿæˆçš„é€‰é¡¹ç±»ä»£ç 
   */
  generateOptionsClass(
    componentName: string,
    properties: PropertyDefinition[]
  ): string {
    const className = `${componentName}Options`;
    
    // ç”Ÿæˆå±æ€§å£°æ˜ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿï¼‰
    const propertyDeclarations = properties.map(prop => 
      this.generatePropertyDeclaration(prop)
    ).join('\n    ');
    
    // ç”Ÿæˆä¾¿åˆ©æ„é€ æ–¹æ³•ï¼ˆåŸºäºä»“é¢‰è¯­è¨€é“¾å¼è°ƒç”¨æ¨¡å¼ï¼‰
    const builderMethods = this.generateBuilderMethods(componentName, properties);
    
    // ç”Ÿæˆé€‰é¡¹ç±»ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å®šä¹‰è§„èŒƒï¼‰
    return `@Derive[Equatable]
@!APILevel[12]
public class ${className} {
    ${propertyDeclarations}
    
    // é»˜è®¤æ„é€ å‡½æ•°ï¼ˆåŸºäºä»“é¢‰è¯­è¨€æ„é€ å‡½æ•°è§„èŒƒï¼‰
    public init() {
        // ä½¿ç”¨é»˜è®¤å€¼åˆå§‹åŒ–
    }
    
    ${builderMethods}
}`;
  }
  
  /**
   * ç”Ÿæˆå±æ€§å£°æ˜ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿï¼‰
   * @param prop å±æ€§å®šä¹‰
   * @returns å±æ€§å£°æ˜ä»£ç 
   */
  private generatePropertyDeclaration(prop: PropertyDefinition): string {
    const cangjieType = this.mapToCangjieType(prop.type);
    const defaultValue = this.generateDefaultValue(prop, cangjieType);
    
    return `public var ${prop.name}!: ${cangjieType} = ${defaultValue}`;
  }
  
  /**
   * æ˜ å°„åˆ°ä»“é¢‰è¯­è¨€ç±»å‹ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿï¼‰
   * @param tsType TypeScript ç±»å‹
   * @returns ä»“é¢‰è¯­è¨€ç±»å‹
   */
  private mapToCangjieType(tsType: string): string {
    // æ£€æŸ¥è¯­ä¹‰åŒ–ç±»å‹æ˜ å°„
    for (const [pattern, cangjieType] of this.semanticTypeMap) {
      if (tsType.includes(pattern)) {
        return cangjieType;
      }
    }
    
    // æ£€æŸ¥æ˜¯å¦ä¸ºæšä¸¾ç±»å‹
    if (tsType.includes('|') && !tsType.includes('Union_')) {
      return this.extractEnumType(tsType);
    }
    
    // æ£€æŸ¥æ˜¯å¦ä¸ºå›è°ƒå‡½æ•°ç±»å‹
    if (tsType.includes('=>') || tsType.includes('Callback')) {
      return 'Option<() -> Unit>';
    }
    
    // é»˜è®¤æ˜ å°„
    const typeMap: Record<string, string> = {
      'string': 'ResourceStr',
      'number': 'Float64',
      'boolean': 'Bool',
      'int': 'Int64',
      'float': 'Float64',
      'any': 'Any',
      'void': 'Unit',
      'null': 'Unit',
      'undefined': 'Unit'
    };
    
    return typeMap[tsType] || 'Any';
  }
  
  /**
   * ç”Ÿæˆé»˜è®¤å€¼ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿï¼‰
   * @param prop å±æ€§å®šä¹‰
   * @param cangjieType ä»“é¢‰è¯­è¨€ç±»å‹
   * @returns é»˜è®¤å€¼ä»£ç 
   */
  private generateDefaultValue(prop: PropertyDefinition, cangjieType: string): string {
    // åŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿç”Ÿæˆé»˜è®¤å€¼
    const defaultValueMap: Record<string, string> = {
      'ResourceStr': '""',
      'ResourceColor': 'Color.Transparent',
      'Length': 'Length.Auto',
      'Float64': '0.0',
      'Int64': '0',
      'Bool': 'false',
      'Duration': 'Duration.of(0)',
      'Option<() -> Unit>': 'None',
      'ArrayList<T>': 'ArrayList<T>()'
    };
    
    // æ£€æŸ¥æ˜¯å¦æœ‰è‡ªå®šä¹‰é»˜è®¤å€¼
    if (prop.defaultValue) {
      return this.convertToCangjieValue(prop.defaultValue, cangjieType);
    }
    
    // ä½¿ç”¨ç±»å‹é»˜è®¤å€¼
    return defaultValueMap[cangjieType] || 'null';
  }
  
  /**
   * è½¬æ¢ä¸ºä»“é¢‰è¯­è¨€å€¼ï¼ˆåŸºäºä»“é¢‰è¯­è¨€è¯­æ³•è§„èŒƒï¼‰
   * @param value åŸå§‹å€¼
   * @param cangjieType ä»“é¢‰è¯­è¨€ç±»å‹
   * @returns è½¬æ¢åçš„å€¼
   */
  private convertToCangjieValue(value: string, cangjieType: string): string {
    switch (cangjieType) {
      case 'ResourceStr':
        return `"${value}"`;
      case 'ResourceColor':
        return `Color.${this.capitalize(value)}`;
      case 'Length':
        return `${value}.vp`;
      case 'Float64':
        return `${value}.0`;
      case 'Int64':
        return value;
      case 'Bool':
        return value.toLowerCase();
      case 'Duration':
        return `Duration.of(${value})`;
      default:
        return value;
    }
  }
  
  /**
   * æå–æšä¸¾ç±»å‹ï¼ˆåŸºäºä»“é¢‰è¯­è¨€æšä¸¾ç±»å‹ç³»ç»Ÿï¼‰
   * @param unionType è”åˆç±»å‹å­—ç¬¦ä¸²
   * @returns æšä¸¾ç±»å‹åç§°
   */
  private extractEnumType(unionType: string): string {
    // ä»è”åˆç±»å‹ä¸­æå–æšä¸¾åç§°
    const literals = unionType.split('|').map(s => s.trim().replace(/['"]/g, ''));
    const enumName = this.generateEnumName(literals);
    return enumName;
  }
  
  /**
   * ç”Ÿæˆæšä¸¾åç§°ï¼ˆåŸºäºä»“é¢‰è¯­è¨€å‘½åè§„èŒƒï¼‰
   * @param literals å­—é¢é‡æ•°ç»„
   * @returns æšä¸¾åç§°
   */
  private generateEnumName(literals: string[]): string {
    // åŸºäºå­—é¢é‡å†…å®¹æ¨æ–­æšä¸¾åç§°
    if (literals.every(l => ['left', 'center', 'right'].includes(l))) {
      return 'HorizontalAlign';
    }
    if (literals.every(l => ['top', 'middle', 'bottom'].includes(l))) {
      return 'VerticalAlign';
    }
    if (literals.every(l => ['small', 'medium', 'large'].includes(l))) {
      return 'ComponentSize';
    }
    if (literals.every(l => ['light', 'dark', 'auto'].includes(l))) {
      return 'ThemeType';
    }
    
    // é»˜è®¤å‘½å
    return 'CustomEnum';
  }
  
  /**
   * ç”Ÿæˆä¾¿åˆ©æ„é€ æ–¹æ³•ï¼ˆåŸºäºä»“é¢‰è¯­è¨€é“¾å¼è°ƒç”¨æ¨¡å¼ï¼‰
   * @param componentName ç»„ä»¶åç§°
   * @param properties å±æ€§å®šä¹‰æ•°ç»„
   * @returns ä¾¿åˆ©æ„é€ æ–¹æ³•ä»£ç 
   */
  private generateBuilderMethods(
    componentName: string, 
    properties: PropertyDefinition[]
  ): string {
    return properties.map(prop => {
      const methodName = `set${this.capitalize(prop.name)}`;
      const cangjieType = this.mapToCangjieType(prop.type);
      
      return `  /**
   * è®¾ç½® ${prop.name} å±æ€§ï¼ˆåŸºäºä»“é¢‰è¯­è¨€é“¾å¼è°ƒç”¨æ¨¡å¼ï¼‰
   * @param value ${prop.name} çš„å€¼
   * @returns å½“å‰é€‰é¡¹ç±»å®ä¾‹ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨
   */
  public func ${methodName}(value: ${cangjieType}): ${componentName}Options {
    this.${prop.name} = value
    return this
  }`;
    }).join('\n\n');
  }
  
  /**
   * é¦–å­—æ¯å¤§å†™ï¼ˆåŸºäºä»“é¢‰è¯­è¨€å‘½åè§„èŒƒï¼‰
   * @param str è¾“å…¥å­—ç¬¦ä¸²
   * @returns é¦–å­—æ¯å¤§å†™çš„å­—ç¬¦ä¸²
   */
  private capitalize(str: string): string {
    return str.charAt(0).toUpperCase() + str.slice(1);
  }
  
  /**
   * ç”Ÿæˆä¼˜åŒ–æŠ¥å‘Šï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿï¼‰
   * @param properties å±æ€§å®šä¹‰æ•°ç»„
   * @returns ä¼˜åŒ–æŠ¥å‘Š
   */
  generateOptimizationReport(properties: PropertyDefinition[]): OptionsOptimizationReport {
    const semanticTypes = properties.filter(prop => 
      this.semanticTypeMap.has(this.mapToCangjieType(prop.type))
    ).length;
    
    const enumTypes = properties.filter(prop => 
      prop.type.includes('|') && !prop.type.includes('Union_')
    ).length;
    
    const callbackTypes = properties.filter(prop => 
      prop.type.includes('=>') || prop.type.includes('Callback')
    ).length;
    
    return {
      totalProperties: properties.length,
      semanticTypes,
      enumTypes,
      callbackTypes,
      estimatedReadability: this.calculateReadability(properties)
    };
  }
  
  /**
   * è®¡ç®—å¯è¯»æ€§è¯„åˆ†ï¼ˆåŸºäºä»“é¢‰è¯­è¨€æœ€ä½³å®è·µï¼‰
   * @param properties å±æ€§å®šä¹‰æ•°ç»„
   * @returns å¯è¯»æ€§è¯„åˆ†
   */
  private calculateReadability(properties: PropertyDefinition[]): string {
    const semanticRatio = properties.filter(prop => 
      this.semanticTypeMap.has(this.mapToCangjieType(prop.type))
    ).length / properties.length;
    
    const enumRatio = properties.filter(prop => 
      prop.type.includes('|') && !prop.type.includes('Union_')
    ).length / properties.length;
    
    const totalScore = (semanticRatio * 0.6 + enumRatio * 0.4) * 100;
    
    if (totalScore >= 80) return 'ä¼˜ç§€';
    if (totalScore >= 60) return 'è‰¯å¥½';
    if (totalScore >= 40) return 'ä¸€èˆ¬';
    return 'éœ€è¦æ”¹è¿›';
  }
}

/**
 * å±æ€§å®šä¹‰æ¥å£ï¼ˆåŸºäºä»“é¢‰è¯­è¨€ç±»å‹ç³»ç»Ÿï¼‰
 */
interface PropertyDefinition {
  name: string;
  type: string;
  hasDefault: boolean;
  defaultValue?: string;
  optional: boolean;
  description?: string;
}

/**
 * é€‰é¡¹ç±»ä¼˜åŒ–æŠ¥å‘Šæ¥å£
 */
interface OptionsOptimizationReport {
  totalProperties: number;
  semanticTypes: number;
  enumTypes: number;
  callbackTypes: number;
  estimatedReadability: string;
}
```

</details>

---

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

**ç‰ˆæœ¬**: v1.1  
**æœ€åæ›´æ–°**: 2024å¹´12æœˆ  
**è´Ÿè´£äºº**: dts2peer å¼€å‘å›¢é˜Ÿ  
**ä¼˜åŒ–é‡ç‚¹**: åŸºäºä»“é¢‰è¯­è¨€æšä¸¾ç±»å‹ç³»ç»Ÿå’Œé€‰é¡¹ç±»æ¨¡å¼çš„ä¼˜åŒ–  
**æ–‡æ¡£çŠ¶æ€**: å®Œæ•´ä¼˜åŒ–ï¼ŒåŒ…å«å®æ–½æŒ‡å—å’Œæœ€ä½³å®è·µ

## ğŸ¯ ä¸»è¦ä¼˜åŒ–å†…å®¹

**1. ä»“é¢‰è¯­è¨€æšä¸¾ç±»å‹ç³»ç»Ÿæ·±åº¦é›†æˆ**
- âœ… ä½¿ç”¨ `@Derive[Equatable]` æ³¨è§£ï¼Œæä¾›ç±»å‹å®‰å…¨çš„æ¯”è¾ƒæ“ä½œ
- âœ… éµå¾ªä»“é¢‰è¯­è¨€çš„ PascalCase æšä¸¾å€¼å‘½åè§„èŒƒ
- âœ… ä½¿ç”¨ `@!APILevel[12]` æ³¨è§£ï¼Œç¡®ä¿ API å…¼å®¹æ€§
- âœ… æ™ºèƒ½æ˜ å°„æ•°å­—ã€è¿å­—ç¬¦å’Œä¸‹åˆ’çº¿ä¸ºç¬¦åˆè§„èŒƒçš„æšä¸¾å€¼

**2. é€‰é¡¹ç±»æ¨¡å¼ä¼˜åŒ–**
- âœ… ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„è¯­ä¹‰åŒ–ç±»å‹ï¼ˆ`ResourceStr`ã€`Length`ã€`ResourceColor`ï¼‰
- âœ… æ”¯æŒä»“é¢‰è¯­è¨€çš„é“¾å¼è°ƒç”¨æ¨¡å¼ï¼Œæé«˜ API ä¾¿åˆ©æ€§
- âœ… ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„ `Option<T>` ç±»å‹ç³»ç»Ÿå¤„ç†å¯é€‰å›è°ƒ
- âœ… æä¾›ç±»å‹å®‰å…¨çš„é»˜è®¤å€¼ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯

**3. å­—é¢é‡è”åˆç±»å‹æ™ºèƒ½è½¬æ¢**
- âœ… è‡ªåŠ¨è¯†åˆ« TypeScript å­—é¢é‡è”åˆç±»å‹å¹¶è½¬æ¢ä¸º Cangjie æšä¸¾
- âœ… åŸºäºè¯­ä¹‰æ¨æ–­åˆé€‚çš„æšä¸¾åç§°
- âœ… å‡å°‘å¤æ‚çš„ `Union_*` ç±»ï¼Œç®€åŒ–ç±»å‹ç³»ç»Ÿç»“æ„
- âœ… æä¾›è¯­ä¹‰åŒ–çš„æšä¸¾ç±»å‹ï¼Œæé«˜ä»£ç å¯è¯»æ€§

**4. å¤æ‚æšä¸¾ç»„åˆå¤„ç†**
- âœ… æ‰å¹³åŒ–å¤æ‚åµŒå¥—ç»“æ„ï¼Œç®€åŒ–ç±»å‹å®šä¹‰
- âœ… ä½¿ç”¨ä»“é¢‰è¯­è¨€çš„é€‰é¡¹ç±»æ¨¡å¼ï¼Œæä¾›ä¾¿åˆ©çš„ API
- âœ… æ”¯æŒä»“é¢‰è¯­è¨€çš„ `ArrayList` å’Œ `Option<T>` ç±»å‹ç³»ç»Ÿ
- âœ… æ™ºèƒ½å¤„ç†æ•°ç»„å’Œå¯¹è±¡ä¸­çš„æšä¸¾ç±»å‹

**5. æšä¸¾å€¼æ™ºèƒ½æ˜ å°„**
- âœ… æ™ºèƒ½å¤„ç†æ•°å­—ã€è¿å­—ç¬¦å’Œä¸‹åˆ’çº¿çš„æ˜ å°„
- âœ… ä¿æŒè¯­ä¹‰çš„å‡†ç¡®æ€§å’Œå¯è¯»æ€§
- âœ… æä¾›ç±»å‹å®‰å…¨çš„é»˜è®¤å€¼
- âœ… éµå¾ªä»“é¢‰è¯­è¨€çš„å‘½åè§„èŒƒå’Œç±»å‹ç³»ç»Ÿ

## ğŸ“Š é¢„æœŸæ”¹è¿›æ•ˆæœ

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æ”¹è¿›å¹…åº¦ |
|------|--------|--------|----------|
| **æšä¸¾ç±»å‹æ•°é‡** | 0 | 50+ | æ–°å¢ 100% |
| **Union_* ç±»æ•°é‡** | 100+ | 20-30 | å‡å°‘ 70%+ |
| **ä»£ç å¯è¯»æ€§** | å·® | å¥½ | æ˜¾è‘—æå‡ |
| **ç±»å‹å®‰å…¨æ€§** | ä¸€èˆ¬ | é«˜ | æ˜¾è‘—æå‡ |
| **API ä¾¿åˆ©æ€§** | ä½ | é«˜ | æ˜¾è‘—æå‡ |
| **è¯­ä¹‰åŒ–ç±»å‹ä½¿ç”¨** | æ—  | å…¨é¢ | 100% è¦†ç›– |
| **é“¾å¼è°ƒç”¨æ”¯æŒ** | æ—  | å…¨é¢ | 100% è¦†ç›– |

